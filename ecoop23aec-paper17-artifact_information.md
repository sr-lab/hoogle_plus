# Artifact Submission Template

Title of the submitted paper: Synthesis of Constants and lambda-abstractions in Petri-net-based Synthesis using Symbolic Execution
ECOOP submission number for the paper: 150

## Overview: What does the artifact comprise?

* The artifact is a **Docker image** containing the **Haskell source code** of the extension to Hoogle+ described in the paper. The artifact is already compiled and ready to use. For evaluation purposes, it also includes the two versions of Hoogle. 
* The Docker image can be found at FIXME
* We claim the functional and reusable badge. FIXME available

## Claims about the artifact’s functionality to be evaluated by the committee

In our paper, we propose an extension to the Hoogle+ program synthesizer so that it synthesizes solutions with constants and lambda abstractions. The artifact contains the implementation of the extension and allows each one to run benchmarks and see the code. Thereby, we claim the functional badge.

* The artifact is *consistent*: it is relevant to the paper, as it implements the extension to Hoogle+, described in the paper, and generates tables 3 and 4 of Section 5 of the paper, which summarize the evaluation.

* The artifact is *complete*: it contains the extension made to Hoogle+, described in Section 4 of the paper, whose source code is present in the folders `/home/hoogle_plus_ext/app` and `/home/hoogle_plus_ext/src`. The unification algorithm, described in Section 3 of the paper, is implemented in the folder `/home/hoogle_plus_ext/src/SymbolicMatch`.

* The artifact is *exercisable*: Tables 3 and 4 of the paper can be generated by running the script `/home/eval.sh`, which produces a latex file in the stdout.
    ```
    cd /home
    sh eval.sh
    ```

* The artifact is *documented*. The code is commented and we map each algorithm on the paper to a function/module in the artifact:
    - Algorithm 1: function eval in `/home/hoogle_plus_ext/src/SymbolicMatch/Eval.hs`;
    - Algorithm 2: functions main and executeSearch in `/home/hoogle_plus_ext/app/HooglePlus.hs`;
    - Algorithm 3: functions executeCheck and runExampleChecks in `/home/hoogle_plus_ext/src/HooglePlus/GHCChecker.hs`, and function REPLACE-WILDCARD corresponds to functions replaceLamsInProg and replaceSymsInProg in `/home/hoogle_plus_ext/src/HooglePlus/GHCChecker.hs` and function CONVERT-TO-H+ corresponds to showExpr, in (`/home/hoogle_plus_ext/src/SymbolicMatch/Expr.hs`);
    - Algorithm 4: function synthLamba `/home/hoogle_plus_ext/src/HooglePlus/GHCChecker.hs` and function linearSynth in `/home/hoogle_plus_ext/src/HooglePlus/LinearSynth.hs`;
    - Algorithm 5: function completeExpr in `/home/hoogle_plus_ext/src/HooglePlus/LinearSynth.hs`;
    - Algorithm 6: function applyMatch in `/home/hoogle_plus_ext/src/HooglePlus/LinearSynth.hs`;
    - The addition of the wildcard component is done by function generateEnv, in `/home/hoogle_plus_ext/src/Database/Environment.hs`
    - The unification algorithm is implemented in function match (`/home/hoogle_plus_ext/src/SymbolicMatch/Match.hs`). Each case of this function is related to an inference rule presented in the paper.

## Claims about the artifact’s reusability to be evaluated by the committee
* To change the way the ocurrences of the wildcard component are replaced, simply redefine the function runExampleChecks (`/home/hoogle_plus_ext/src/HooglePlus/GHCChecker.hs`).
* The code is documented, which simplifies future extensions.

## Artifact Requirements
Only `docker` is required.

## Getting Started FIXME url
* The artifact is delivered as a docker image. Download the image from https://drive.google.com/drive/folders/1PdpeEQQU1E-C8hedV_37mAn9EPs_EcLm?usp=sharing and run the following command in the folder where the image is stored:
  ```
  docker load < paper65_r1_image.tar.gz FIXME NAME
  ```
  To run the image,
  ```
  docker run -it paper65_aec:latest FIXME NAME
  ```

* The artifact includes the extension to the Hoogle+, in folder `/home/hoogle_plus_ext/`, as well as two versions of Hoogle+, for comparasion and evaluation.

* All three versions are compiled and ready to use.
* The script `/home/eval.sh` does the following:
    - It runs the first set of 44 benchmarks that do not require examples in the extension and the original version of Hoogle+;
    - It runs the second set of 26 benchmarks that use input-output examples in the extension and in the version of Hoogle+ that supports examples; FIXME TIME
    - It takes 2 hours approx; to run only the second set of 26 benchmarks (which is the most important set because its benchmarks require the generation of constants and lambda-abstractions), pass S2 as an argument (`sh eval.sh S2`), and this should take 40 minutes; FIXME TIME
    - It prints a LaTeX document in the `stdout`;
* The scripts `/home/hoogle_plus_ext/eval_ext.hs`, `/home/hoogle_plus_examp/eval_examp.hs` and `/home/hoogle_plus_orig/eval_orig.hs` can be used separately to run the benchmarks on specific versions.         
  - Each one creates a folder `logs` (for instance, the `eval_ext.sh` creates a folder `/home/hoogle_plus_ext/logs`), containing a log file for each benchmark (with the produced solutions and times). The arguments `S2` and `S1` can be used in script `/home/hoogle_plus_ext/eval_ext.hs`, to select one of both sets of benchmarks.           FIXME TIME
  - For an even shorter evaluation, run the 26 benchmarks (only on the extension) that take input-output examples (approx. 20 minutes). This is the most relevant set of benchmarks, as most of them require the generation of constants and lambda abstractions, which is the key contribution of our work.
    ```
    cd /home/hoogle_plus_ext
    sh eval_ext.sh S2
    ```
  - Each log file contains, for each solution, a line with the output and a line with the times. In the case of Hoogle+ and Hoogle+ with examples, there is a single time: the total time spent. In the case of the extension, the time spent replacing wildcards is also provided, and this is the first value of the line.
  
* To run a problem in the extension, `cd /home/hoogle_plus_ext/` and use `stack exec`. For instance, if the goal is to synthesize a function `[Int] -> [Int]` that adds 1 to each element of the input list, we can supply the input-output example `[([[1, 2, 3]], [2, 3, 4])]`:
    ```
    cd /home/hoogle_plus_ext
    stack exec -- hplus "[Int] -> [Int]" --example="[([[1, 2, 3]], [2, 3, 4])]" --cnt=35
    ```
    Note that the argument `--cnt` specifies the number of incomplete functions that should be generated, and we have used `35` in benchmarks that require input-output examples, as explained in the paper.

* To the previous problem in the version of Hoogle+ with examples:
    ```
    cd /home/hoogle_plus_examp
    stack exec -- hplus --json='{"query":"[Int] -> [Int]", "inExamples":[{"inputs":["[1, 2, 3]"],"output":"[2, 3, 4]"}]}' --cnt=35
    ```
* The original version of Hoogle+ does not support examples, so we only can provide a query type:
    ```
    cd /home/hoogle_plus_orig
    stack exec -- hplus "[Int] -> [Int]" --cnt=35
    ```